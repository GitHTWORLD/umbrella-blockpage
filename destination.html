
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Access Blocked by HTWORLD IT Dept</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 40px; }
        .logo img { width: 120px; margin-bottom: 20px; }
        .warning-box { border: 1px solid #ccc; padding: 20px; margin: 20px auto; width: 60%; background-color: #f9f9f9; border-radius: 8px; }
        .warning-icon { color: #ff9900; font-size: 24px; margin-bottom: 10px; }
        .domain { font-weight: bold; font-size: 18px; margin: 10px 0; }
        .footer-links { margin-top: 20px; font-size: 14px; }
        .footer-links a { margin: 0 10px; color: #0073e6; text-decoration: none; }
    </style>
</head>
<body>
    <!-- Logo -->
    <div class="logo">
        <img src="https://raw.githubusercontent.com/GitHTWORLD/umbrella-blockpage/main/images/htworld-logo.png" alt="HTWORLD Logo">
    </div>

    <!-- Warning Box -->
    <div class="warning-box">
        <div class="warning-icon">âš </div>
        <h2>This site is blocked due to Destination List Policy</h2>

        <!-- Domain placeholder -->
        <div class="domain" id="domain">[domain]</div>

        <!-- Your wording -->
        <p>Dougal has blocked this website as it is not allowed based on the policies set forth by the HTWORLD IT Dept.</p>
        <p>
            If you believe this site to be blocked in error, submit a form below with your comments notating
            <span id="policy">HTWORLD IT Dept</span> blocked you, and why you believe it should be lifted.
        </p>
        <p>Your form will be reviewed by our technicians and an email will be sent when a determination has been made.</p>

        <!-- Links -->
        <div class="footer-links">
            <a href="https://yourformlink.com">Submit Unblock Request</a> |
            <a href="#report">Report Incorrect Block</a> |
            <a href="#diagnostic">Diagnostic Info</a>
        </div>
    </div>

    <!-- Robust parameter parsing -->
    <script>
      // Helper: ROT13 decode
      function rot13(str) {
        return str.replace(/[a-zA-Z]/g, function(c){
          const base = c <= 'Z' ? 65 : 97;
          return String.fromCharCode(((c.charCodeAt(0) - base + 13) % 26) + base);
        });
      }

      // Helper: safely get hostname from a URL string
      function extractHostname(urlStr) {
        try {
          const decodedFirst = decodeURIComponent(urlStr);
          const looksRot13 = decodedFirst.startsWith('uggc://');
          const decoded = looksRot13 ? rot13(decodedFirst) : decodedFirst;
          const u = new URL(decoded);
          return u.hostname;
        } catch (e) {
          try {
            const decoded = decodeURIComponent(urlStr);
            return decoded
              .replace(/^https?:\/\//i, '')
              .replace(/^uggc:\/\//i, rot13('uggc://').replace(/^https?:\/\//i, ''))
              .split('/')[0];
          } catch (e2) {
            return '';
          }
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);

        // DOMAIN: prefer ?domain=; else derive from ?url=
        let domain = params.get('domain');
        if (!domain) {
          const urlParam = params.get('url');
          if (urlParam) domain = extractHostname(urlParam);
        }
        const domainEl = document.getElementById('domain');
        if (domainEl) domainEl.textContent = domain || '[domain]';

        // POLICY name (if Umbrella provides it)
        const policyEl = document.getElementById('policy');
        if (policyEl) policyEl.textContent = params.get('policy') || 'HTWORLD IT Dept';

        // (Optional) Identity or Category if you decide to add later:
        // const identityEl = document.getElementById('identity');
        // if (identityEl) identityEl.textContent = params.get('identity') || 'Unknown Identity';
        // const categoryEl = document.getElementById('category');
        // if (categoryEl) categoryEl.textContent = params.get('category') || '';
      });
    </script>
</body>
</html>
